// Generated by CoffeeScript 1.9.1
(function() {
  var Promise, debug, error, log;

  Promise = require("bluebird");

  debug = require('debug');

  log = debug('atop:debug');

  log.log = console.log.bind(console);

  error = debug('atop:error');

  module.exports = {
    error: function(err) {
      return console.error(err.status || err, new Error().stack);
    },
    json: function(res) {
      return res.json();
    },
    status: function(res) {
      var ref;
      return Promise[['reject', 'resolve'][+((200 <= (ref = res.status) && ref < 400))]](res);
    },
    atop: function(json) {
      var isSuccess, result;
      if (json == null) {
        json = {};
      }
      isSuccess = json.status === 'ok' || !!json.success;
      result = isSuccess ? (json.result !== void 0 ? json.result : json) : json;
      if (isSuccess) {
        log(json);
      } else {
        error(json);
      }
      return Promise[['reject', 'resolve'][+isSuccess]](result);
    }
  };

}).call(this);
